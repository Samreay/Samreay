<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>A visual tutorial of Rejection Sampling - Samuel Hinton</title><link rel=stylesheet href="https://cosmiccoding.com.au/css/main.min.5885372f23ef07b79bc16e6f2da719ab7aef8e679a9f36a46a5dfe568f4d60e7.css" integrity="sha256-WIU3LyPvB7ebwW5vLacZq3rvjmeanzakal3+Vo9NYOc="><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel="shortcut icon" href=https://cosmiccoding.com.au/img/favicon.png type=image/x-icon></head><meta name=description content="Von Neumann rejection sampling explained with Python and animations."><meta name=robots content="noodp"><link rel=canonical href=https://cosmiccoding.com.au/tutorials/rejection_sampling/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cosmiccoding.com.au/tutorials/rejection_sampling/cover.png"><meta name=twitter:title content="A visual tutorial of Rejection Sampling"><meta name=twitter:description content="Von Neumann rejection sampling explained with Python and animations."><meta property="og:title" content="A visual tutorial of Rejection Sampling"><meta property="og:description" content="Von Neumann rejection sampling explained with Python and animations."><meta property="og:type" content="article"><meta property="og:url" content="https://cosmiccoding.com.au/tutorials/rejection_sampling/"><meta property="og:image" content="https://cosmiccoding.com.au/tutorials/rejection_sampling/cover.png"><meta property="article:section" content="tutorials"><meta property="article:published_time" content="2020-06-16T00:00:00+00:00"><meta property="article:modified_time" content="2020-06-16T00:00:00+00:00"><meta property="article:section" content="tutorial"><meta property="article:published_time" content="2020-06-16 00:00:00 +0000 UTC"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"A visual tutorial of Rejection Sampling","genre":"tutorial","url":"https:\/\/cosmiccoding.com.au\/tutorials\/rejection_sampling\/","datePublished":"2020-06-16 00:00:00 \u002b0000 UTC","description":"Von Neumann rejection sampling explained with Python and animations.","author":{"@type":"Person","name":""}}</script><body><div class="flex flex-col min-h-screen overflow-hidden"><header class="absolute w-full z-30"><div class="max-w-6xl mx-auto px-4 sm:px-6"><div class="flex items-center justify-between h-20"><div class="flex-shrink-0 mr-4"><a class=block href=/ aria-label="Samuel Hinton"><h2 class=logo>SRH</h2></a></div><nav class="hidden md:flex md:flex-grow"><ul class="flex flex-grow justify-end flex-wrap items-center"><li><a href=/#books class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Books</a></li><li><a href=/reviews class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Reviews</a></li><li><a href=/tutorials class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Tutorials</a></li><li><a href=/blogs class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Blog</a></li><li><a href=/#courses class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Courses</a></li><li><a href=/static/resume/HintonCV.pdf class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">CV</a></li></ul></nav><div class=md:hidden x-data="{ expanded: false }"><button class=hamburger :class="{ 'active': expanded }" @click.stop="expanded = !expanded" aria-controls=mobile-nav :aria-expanded=expanded>
<span class=sr-only>Menu</span><svg class="w-6 h-6 fill-current text-gray-300 hover:text-gray-200 transition duration-150 ease-in-out" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect y="4" width="24" height="2" rx="1"/><rect y="11" width="24" height="2" rx="1"/><rect y="18" width="24" height="2" rx="1"/></svg></button><nav id=mobile-nav class="absolute top-full z-20 left-0 w-full px-4 sm:px-6 overflow-hidden transition-all duration-300 ease-in-out" x-ref=mobileNav :style="expanded ? 'max-height: ' + $refs.mobileNav.scrollHeight + 'px; opacity: 1' : 'max-height: 0; opacity: .8'" @click.away="expanded = false" @keydown.escape.window="expanded = false" x-cloak><ul class="bg-gray-800 px-4 py-2"><li><a href=/#books class="flex text-gray-300 hover:text-gray-200 py-2">Books</a></li><li><a href=/reviews class="flex text-gray-300 hover:text-gray-200 py-2">Reviews</a></li><li><a href=/tutorials class="flex text-gray-300 hover:text-gray-200 py-2">Tutorials</a></li><li><a href=/blogs class="flex text-gray-300 hover:text-gray-200 py-2">Blog</a></li><li><a href=/#courses class="flex text-gray-300 hover:text-gray-200 py-2">Courses</a></li><li><a href=/static/resume/HintonCV.pdf class="flex text-gray-300 hover:text-gray-200 py-2">CV</a></li></ul></nav></div></div></div></header><div class=flex-grow><div id=post-container class="content content-wider blog-post relative"><div class="section-header blog"><h1 class=title>A visual tutorial of Rejection Sampling</h1><p>6th June 2020</p><p>Von Neumann rejection sampling explained with Python and animations.</p></div><div><ul class="grid gap-6 w-full md:grid-cols-2" style=list-style:none;padding-left:0><li><input type=radio id=show-code name=code-toggle value=show-code class="hidden peer" onchange=clickCheckbox(this) required checked>
<label for=show-code class="inline-flex justify-between items-center p-5 w-full text-gray-500 bg-gray-800 rounded-lg border border-gray-200 cursor-pointer peer-checked:border-2 peer-checked:border-main-300 peer-checked:text-white peer-checked:bg-gray-700 hover:text-gray-200 hover:bg-gray-700"><div class="block w-full"><div class="w-full text-center text-lg font-semibold">Show me everything!</div><div class="w-full text-center text-sm">Oh yeah, coding time.</div></div></label></li><li><input type=radio id=hide-code name=code-toggle value=hide-code class="hidden peer" onchange=clickCheckbox(this)>
<label for=hide-code class="inline-flex justify-between items-center p-5 w-full text-gray-500 bg-gray-800 rounded-lg border border-gray-200 cursor-pointer peer-checked:border-2 peer-checked:border-main-300 peer-checked:text-white peer-checked:bg-gray-700 hover:text-gray-200 hover:bg-gray-700"><div class="block w-full"><div class="w-full text-center text-lg font-semibold">Just the plots</div><div class="w-full text-center text-sm">Code is nasty.</div></div></label></li></ul></div><script>function clickCheckbox(e){e.id=="show-code"?document.getElementById("post-container").classList.remove("hide-code"):document.getElementById("post-container").classList.add("hide-code")}</script><p>Rejection sampling is the conceptually simplest way to generate samples of some arbitrary probability function without having to do any transformations. No integration, no trickery, you simply trade computational efficiency away to keep everything as simple as possible.</p><p>Let&rsquo;s pick a super simple example: let&rsquo;s say you want to sample from the function</p><p>$$ f(x) = 1.2 - x^4 $$</p><p>between 0 and 1. It just happens this does integrate to 1, what luck! Let&rsquo;s visualise this function very quickly:</p><div class="expanded-code width-82" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>import</span> numpy <span style=color:#ff6ac1>as</span> np
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib.pyplot <span style=color:#ff6ac1>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>f</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> <span style=color:#ff9f43>1.2</span> <span style=color:#ff6ac1>-</span> x<span style=color:#ff6ac1>**</span><span style=color:#ff9f43>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xs <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>, <span style=color:#ff9f43>1000</span>)
</span></span><span style=display:flex><span>ys <span style=color:#ff6ac1>=</span> f(xs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>) 
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.25</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend();
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_1_0_hu97273e2fc5e6673545d08428371e66ee_72086_2841x1495_resize_q90_h2_box_3.webp width=2841 height=1495 type=image/webp><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_1_0_hu97273e2fc5e6673545d08428371e66ee_72086_2841x1495_resize_q90_box_3.png width=2841 height=1495 type=image/png><img width=2841 height=1495 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>We can see the function we care about goes from 0 to 1 in the x-axis, and 0 to 1.2 in the y-axis. So to sample from it using rejection sampling is simple:</p><ol><li>Pick two random numbers. One for $x$ (between 0 and 1), one for $y$ (between 0 and 1.2).</li><li>If the $y$ value we randomly picked is less than $f(x)$, keep it, otherwise go back to step 1.</li></ol><p>Simple! Play the animation below to see this in action!</p><p><div class=video><video preload=auto playsinline plays-inline controls autoplay loop muted>
<source src=/tutorials/rejection_sampling/PlotDashed.mp4 type=video/mp4></video></div></p><p>So you can see that the reason this is so straightforward is that we get samples according to the function by simply throwing away the right number of samples when the function has a smaller value. In our function, this means if we get a small $x$ value, we&rsquo;d normally keep the sample (and indeed the distribution is pretty flat for $x&lt;0.5$), but for values close to $x=1$, we&rsquo;d throw them out most of the time!</p><p>Let&rsquo;s write a very simple function that gets us a single sample using this method. See how for rejection sampling, you have to specify an initial box to pick from (the x bounds and the maximum y bound). This does make the algorithm unsuited for distributions that have an infinite range of $x$ values, a pity!</p><div class="reduced-code width-50" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>sample</span>(function, xmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.2</span>):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> <span style=color:#ff6ac1>True</span>:
</span></span><span style=display:flex><span>        x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax)
</span></span><span style=display:flex><span>        y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> y <span style=color:#ff6ac1>&lt;</span> function(x):
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>return</span> x
</span></span></code></pre></div></div><p>Let us use this inefficient algorithm to generate a ten thousand samples, and plot their distribution to make sure it looks like its working</p><div class="expanded-code width-81" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>samps <span style=color:#ff6ac1>=</span> [sample(f) <span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>10000</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>hist(samps, density<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Sample distribution&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.4</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend();
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_7_0_huaeb142e972798f2359f3ad1429d4a7b0_106847_2841x1521_resize_q90_h2_box_3.webp width=2841 height=1521 type=image/webp><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_7_0_huaeb142e972798f2359f3ad1429d4a7b0_106847_2841x1521_resize_q90_box_3.png width=2841 height=1521 type=image/png><img width=2841 height=1521 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Hurray, a working algorithm! Of course, this is incredibly slow, because we&rsquo;re asking for things one at a time. Let&rsquo;s improve that slowly and do batches of 1000 proposals at once.</p><div class="expanded-code width-93" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>batch_sample</span>(function, num_samples, xmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.2</span>, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1000</span>):
</span></span><span style=display:flex><span>    samples <span style=color:#ff6ac1>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> <span style=color:#ff5c57>len</span>(samples) <span style=color:#ff6ac1>&lt;</span> num_samples:
</span></span><span style=display:flex><span>        x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax, size<span style=color:#ff6ac1>=</span>batch)
</span></span><span style=display:flex><span>        y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax, size<span style=color:#ff6ac1>=</span>batch)
</span></span><span style=display:flex><span>        samples <span style=color:#ff6ac1>+=</span> x[y <span style=color:#ff6ac1>&lt;</span> function(x)]<span style=color:#ff6ac1>.</span>tolist()
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> samples[:num_samples]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>samps <span style=color:#ff6ac1>=</span> batch_sample(f, <span style=color:#ff9f43>10000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>hist(samps, density<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Sample distribution&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.4</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;f(x)&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend(); <span style=color:#78787e>##REMOVE</span>
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_9_0_hu8fc64bdc7e11e14c6f31beee9e8d38d4_109508_2841x1521_resize_q90_h2_box_3.webp width=2841 height=1521 type=image/webp><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_9_0_hu8fc64bdc7e11e14c6f31beee9e8d38d4_109508_2841x1521_resize_q90_box_3.png width=2841 height=1521 type=image/png><img width=2841 height=1521 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Whats the speed difference you ask?</p><div class="reduced-code width-41" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>%</span>timeit [sample(f) <span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>10000</span>)]
</span></span></code></pre></div></div><pre><code>55.5 ms ± 2.96 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</code></pre><div class="reduced-code width-30" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>%</span>timeit batch_sample(f, <span style=color:#ff9f43>10000</span>)
</span></span></code></pre></div></div><pre><code>1.05 ms ± 108 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</code></pre><p>64 milliseconds down to 1 millisecond. And we could go even lower if we stop turn numpy arrays into lists and concatenating them, but you get the idea. You may be wondering why we didn&rsquo;t just do it all in one go, why break it into batches. Turns out there is a sweet spot for generating vectors - too small and you waste too much time creating them, too big and things start to slow down as well. 1000 is definitely not the sweet spot, but its sweeter than nothing!</p><h2 id=the-compromises-for-rejection-sampling>The compromises for rejection sampling</h2><p>We&rsquo;ve already touched on the compromises of rejection sampling - inefficiency. Imagine instead of having this beautiful bound function between 0 and 1, we instead want to sample a Gaussian distribution like such:</p><p>$$ f(x) = e^{-\pi x^2} $$</p><p>This is defined over all $x$ values, and $\int_{-\infty}^{\infty} e^{-\pi x^2} = 1$, so it&rsquo;s a proper, normalised probability density function alright. What if we want to make sure that our sampling method can capture even extreme outliers?</p><div class="reduced-code width-38" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>gauss</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> np<span style=color:#ff6ac1>.</span>exp(<span style=color:#ff6ac1>-</span>np<span style=color:#ff6ac1>.</span>pi <span style=color:#ff6ac1>*</span> x<span style=color:#ff6ac1>**</span><span style=color:#ff9f43>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xs <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>1000</span>)
</span></span><span style=display:flex><span>ys <span style=color:#ff6ac1>=</span> gauss(xs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;f(x)&#34;</span>);
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_15_0_hu9a51cb7363763e4ee968e1a6ea4ad558_66925_2794x1495_resize_q90_h2_box_3.webp width=2794 height=1495 type=image/webp><source srcset=/tutorials/rejection_sampling/2020-06-16-Rejection_Sampling_files/2020-06-16-Rejection_Sampling_15_0_hu9a51cb7363763e4ee968e1a6ea4ad558_66925_2794x1495_resize_q90_box_3.png width=2794 height=1495 type=image/png><img width=2794 height=1495 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Theres an awful lot of white space on that plot. Let&rsquo;s modify our batch sample function to just do a certain number of samples, but return whether they passed or failed.</p><div class=width-74 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>batch_sample_2</span>(function, num_samples, xmin<span style=color:#ff6ac1>=-</span><span style=color:#ff9f43>10</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>10</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>):
</span></span><span style=display:flex><span>    x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax, size<span style=color:#ff6ac1>=</span>num_samples)
</span></span><span style=display:flex><span>    y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax, size<span style=color:#ff6ac1>=</span>num_samples)
</span></span><span style=display:flex><span>    passed <span style=color:#ff6ac1>=</span> (y <span style=color:#ff6ac1>&lt;</span> function(x))<span style=color:#ff6ac1>.</span>astype(<span style=color:#ff5c57>int</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> x, y, passed
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x, y, passed <span style=color:#ff6ac1>=</span> batch_sample_2(gauss, <span style=color:#ff9f43>10000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>scatter(x, y, c<span style=color:#ff6ac1>=</span>passed, cmap<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;RdYlGn&#34;</span>, vmin<span style=color:#ff6ac1>=-</span><span style=color:#ff9f43>0.1</span>, vmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.1</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, s<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>10</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>print</span>(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;Efficiency is only </span><span style=color:#5af78e>{</span>passed<span style=color:#ff6ac1>.</span>mean() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>100</span><span style=color:#5af78e>:</span><span style=color:#5af78e>0.1f</span><span style=color:#5af78e>}</span><span style=color:#5af78e>%&#34;</span>)
</span></span></code></pre></div></div><pre><code>Efficiency is only 5.0%
</code></pre><p><div><figure class="img-main rounded"><picture><source srcset=/tutorials/rejection_sampling/cover_hu2494d215d77154c0405f0c0c08eca36d_1139680_2860x1521_resize_q90_h2_box_3.webp width=2860 height=1521 type=image/webp><source srcset=/tutorials/rejection_sampling/cover_hu2494d215d77154c0405f0c0c08eca36d_1139680_2860x1521_resize_q90_box_3.png width=2860 height=1521 type=image/png><img width=2860 height=1521 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>And you can see that we reject 19 out of 20 samples! Super inefficient, and it would only get worse if we set the x limits even wider. In principle, we&rsquo;d them as narrow as we could without having to worry about seeing edges in our generated distributions.</p><p>Anyway, thats rejection sampling. Super simple!</p><hr><p>For your convenience, here&rsquo;s the code in one block:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>import</span> numpy <span style=color:#ff6ac1>as</span> np
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib.pyplot <span style=color:#ff6ac1>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>f</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> <span style=color:#ff9f43>1.2</span> <span style=color:#ff6ac1>-</span> x<span style=color:#ff6ac1>**</span><span style=color:#ff9f43>4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xs <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>, <span style=color:#ff9f43>1000</span>)
</span></span><span style=display:flex><span>ys <span style=color:#ff6ac1>=</span> f(xs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>) 
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.25</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend();
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>sample</span>(function, xmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.2</span>):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> <span style=color:#ff6ac1>True</span>:
</span></span><span style=display:flex><span>        x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax)
</span></span><span style=display:flex><span>        y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> y <span style=color:#ff6ac1>&lt;</span> function(x):
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>return</span> x
</span></span><span style=display:flex><span>samps <span style=color:#ff6ac1>=</span> [sample(f) <span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>10000</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>hist(samps, density<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Sample distribution&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.4</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend();
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>batch_sample</span>(function, num_samples, xmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.2</span>, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1000</span>):
</span></span><span style=display:flex><span>    samples <span style=color:#ff6ac1>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> <span style=color:#ff5c57>len</span>(samples) <span style=color:#ff6ac1>&lt;</span> num_samples:
</span></span><span style=display:flex><span>        x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax, size<span style=color:#ff6ac1>=</span>batch)
</span></span><span style=display:flex><span>        y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax, size<span style=color:#ff6ac1>=</span>batch)
</span></span><span style=display:flex><span>        samples <span style=color:#ff6ac1>+=</span> x[y <span style=color:#ff6ac1>&lt;</span> function(x)]<span style=color:#ff6ac1>.</span>tolist()
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> samples[:num_samples]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>samps <span style=color:#ff6ac1>=</span> batch_sample(f, <span style=color:#ff9f43>10000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Function&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>hist(samps, density<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Sample distribution&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1.4</span>), plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;f(x)&#34;</span>), plt<span style=color:#ff6ac1>.</span>legend(); <span style=color:#78787e>##REMOVE</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>%</span>timeit [sample(f) <span style=color:#ff6ac1>for</span> i <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>10000</span>)]
</span></span><span style=display:flex><span><span style=color:#ff6ac1>%</span>timeit batch_sample(f, <span style=color:#ff9f43>10000</span>)
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>gauss</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> np<span style=color:#ff6ac1>.</span>exp(<span style=color:#ff6ac1>-</span>np<span style=color:#ff6ac1>.</span>pi <span style=color:#ff6ac1>*</span> x<span style=color:#ff6ac1>**</span><span style=color:#ff9f43>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>xs <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>1000</span>)
</span></span><span style=display:flex><span>ys <span style=color:#ff6ac1>=</span> gauss(xs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;f(x)&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>batch_sample_2</span>(function, num_samples, xmin<span style=color:#ff6ac1>=-</span><span style=color:#ff9f43>10</span>, xmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>10</span>, ymax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>):
</span></span><span style=display:flex><span>    x <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span>xmin, high<span style=color:#ff6ac1>=</span>xmax, size<span style=color:#ff6ac1>=</span>num_samples)
</span></span><span style=display:flex><span>    y <span style=color:#ff6ac1>=</span> np<span style=color:#ff6ac1>.</span>random<span style=color:#ff6ac1>.</span>uniform(low<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, high<span style=color:#ff6ac1>=</span>ymax, size<span style=color:#ff6ac1>=</span>num_samples)
</span></span><span style=display:flex><span>    passed <span style=color:#ff6ac1>=</span> (y <span style=color:#ff6ac1>&lt;</span> function(x))<span style=color:#ff6ac1>.</span>astype(<span style=color:#ff5c57>int</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> x, y, passed
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x, y, passed <span style=color:#ff6ac1>=</span> batch_sample_2(gauss, <span style=color:#ff9f43>10000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>plot(xs, ys)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>fill_between(xs, ys, <span style=color:#ff9f43>0</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>scatter(x, y, c<span style=color:#ff6ac1>=</span>passed, cmap<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;RdYlGn&#34;</span>, vmin<span style=color:#ff6ac1>=-</span><span style=color:#ff9f43>0.1</span>, vmax<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1.1</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, s<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>2</span>)
</span></span><span style=display:flex><span>plt<span style=color:#ff6ac1>.</span>xlabel(<span style=color:#5af78e>&#34;x&#34;</span>), plt<span style=color:#ff6ac1>.</span>ylabel(<span style=color:#5af78e>&#34;y&#34;</span>), plt<span style=color:#ff6ac1>.</span>xlim(<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>10</span>), plt<span style=color:#ff6ac1>.</span>ylim(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff5c57>print</span>(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;Efficiency is only </span><span style=color:#5af78e>{</span>passed<span style=color:#ff6ac1>.</span>mean() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>100</span><span style=color:#5af78e>:</span><span style=color:#5af78e>0.1f</span><span style=color:#5af78e>}</span><span style=color:#5af78e>%&#34;</span>)
</span></span></code></pre></div><div class="relative max-w-xl mx-auto my-20"><div class="fancy_card horizontal"><div class=card_translator><div class="card_rotator tiny_rot card_layer"><div class="card_layer newsletter p-2"><div class="newsletter-inner h-full"><div class="relative h-full sib-form-container" id=sib-form-container><div class="mb-6 lg:mb-12 text-center"><h3 class="text-main-200 mb-2 lg:mb-8">Stay in the loop!</h3><p class="text-main-100 text-lg text-opacity-70">For new releases, exclusive giveaways, and reviews.</p></div><form action="https://Cosmiccoding.us5.list-manage.com/subscribe/post?u=aebe5de1d2e40dccb3aeca491&id=3987dd4a1f" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class="validate w-full" target=_blank novalidate><div><input type=email class="w-full appearance-none bg-main-600 mb-4 border border-main-600 bg-opacity-5 focus:border-main-300 rounded-sm px-4 py-3 text-main-100 placeholder-main-100 required" placeholder="Your best email…" aria-label="Your best email…" name=EMAIL required data-required=true id=EMAIL><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_aebe5de1d2e40dccb3aeca491_3987dd4a1f tabindex=-1></div><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class="button btn bg-main-600 hover:bg-main-400 shadow w-full"></div><p id=mce-error-response style=display:none class="text-center mt-2 opacity-50 text-main-200">There was a problem, please try again.</p><p id=mce-success-response style=display:none class="text-center mt-2 opacity-50 text-main-200">Thanks mate, won't let ya down.</p></form></div></div></div><div class="card_layer card_effect card_soft_glare" style=pointer-events:none></div></div></div></div></div></div><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script></div><script language=javascript type=text/javascript src=https://cosmiccoding.com.au/js/main.min.11673d10a962fb5205229607e62ea1d23424d35dad33db7bfe2a09a63d5409fa.js></script>
<script async defer src="https://www.googletagmanager.com/gtag/js?id=UA-72691106-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-72691106-1")</script></div></body></html>