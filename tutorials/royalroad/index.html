<!doctype html><html lang=en-gb><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>RoyalRoad Data Infographic - Samuel Hinton</title><link rel=stylesheet href="https://cosmiccoding.com.au/css/main.min.7fbf65bef988e0cecd6d148a59756085deed3c480729d260d0a30b282b1d7da8.css" integrity="sha256-f79lvvmI4M7NbRSKWXVghd7tPEgHKdJg0KMLKCsdfag="><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel="shortcut icon" href=https://cosmiccoding.com.au/img/favicon.png type=image/x-icon></head><meta name=description content="I was curious about how well stories did on RoyalRoad."><meta name=robots content="noodp"><link rel=canonical href=https://cosmiccoding.com.au/tutorials/royalroad/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://cosmiccoding.com.au/tutorials/royalroad/cover.png"><meta name=twitter:title content="RoyalRoad Data Infographic"><meta name=twitter:description content="I was curious about how well stories did on RoyalRoad."><meta property="og:title" content="RoyalRoad Data Infographic"><meta property="og:description" content="I was curious about how well stories did on RoyalRoad."><meta property="og:type" content="article"><meta property="og:url" content="https://cosmiccoding.com.au/tutorials/royalroad/"><meta property="og:image" content="https://cosmiccoding.com.au/tutorials/royalroad/cover.png"><meta property="article:section" content="tutorials"><meta property="article:published_time" content="2022-10-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-14T00:00:00+00:00"><meta property="article:section" content="tutorial"><meta property="article:published_time" content="2022-10-14 00:00:00 +0000 UTC"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"RoyalRoad Data Infographic","genre":"tutorial","url":"https:\/\/cosmiccoding.com.au\/tutorials\/royalroad\/","datePublished":"2022-10-14 00:00:00 \u002b0000 UTC","description":"I was curious about how well stories did on RoyalRoad.","author":{"@type":"Person","name":""}}</script><body><div class="flex flex-col min-h-screen overflow-hidden"><header class="absolute w-full z-30"><div class="max-w-6xl mx-auto px-4 sm:px-6"><div class="flex items-center justify-between h-20"><div class="flex-shrink-0 mr-4"><a class=block href=/ aria-label="Samuel Hinton"><h2 class=logo>SRH</h2></a></div><nav class="hidden md:flex md:flex-grow"><ul class="flex flex-grow justify-end flex-wrap items-center"><li><a href=/#books class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Books</a></li><li><a href=/reviews class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Reviews</a></li><li><a href=/tutorials class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Tutorials</a></li><li><a href=/blogs class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Blog</a></li><li><a href=/#courses class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">Courses</a></li><li><a href=/static/resume/HintonCV.pdf class="text-gray-300 hover:text-gray-200 px-4 py-2 flex items-center transition duration-150 ease-in-out">CV</a></li></ul></nav><div class=md:hidden x-data="{ expanded: false }"><button class=hamburger :class="{ 'active': expanded }" @click.stop="expanded = !expanded" aria-controls=mobile-nav :aria-expanded=expanded>
<span class=sr-only>Menu</span><svg class="w-6 h-6 fill-current text-gray-300 hover:text-gray-200 transition duration-150 ease-in-out" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect y="4" width="24" height="2" rx="1"/><rect y="11" width="24" height="2" rx="1"/><rect y="18" width="24" height="2" rx="1"/></svg></button><nav id=mobile-nav class="absolute top-full z-20 left-0 w-full px-4 sm:px-6 overflow-hidden transition-all duration-300 ease-in-out" x-ref=mobileNav :style="expanded ? 'max-height: ' + $refs.mobileNav.scrollHeight + 'px; opacity: 1' : 'max-height: 0; opacity: .8'" @click.away="expanded = false" @keydown.escape.window="expanded = false" x-cloak><ul class="bg-gray-800 px-4 py-2"><li><a href=/#books class="flex text-gray-300 hover:text-gray-200 py-2">Books</a></li><li><a href=/reviews class="flex text-gray-300 hover:text-gray-200 py-2">Reviews</a></li><li><a href=/tutorials class="flex text-gray-300 hover:text-gray-200 py-2">Tutorials</a></li><li><a href=/blogs class="flex text-gray-300 hover:text-gray-200 py-2">Blog</a></li><li><a href=/#courses class="flex text-gray-300 hover:text-gray-200 py-2">Courses</a></li><li><a href=/static/resume/HintonCV.pdf class="flex text-gray-300 hover:text-gray-200 py-2">CV</a></li></ul></nav></div></div></div></header><div class=flex-grow><div id=post-container class="content content-wider blog-post relative"><div class="section-header blog"><h1 class=title>RoyalRoad Data Infographic</h1><p>6th October 2022</p><p>I was curious about how well stories did on RoyalRoad.</p></div><div><ul class="grid gap-6 w-full md:grid-cols-2" style=list-style:none;padding-left:0><li><input type=radio id=show-code name=code-toggle value=show-code class="hidden peer" onchange=clickCheckbox(this) required checked>
<label for=show-code class="inline-flex justify-between items-center p-5 w-full text-gray-500 bg-gray-800 rounded-lg border border-gray-200 cursor-pointer peer-checked:border-2 peer-checked:border-main-300 peer-checked:text-white peer-checked:bg-gray-700 hover:text-gray-200 hover:bg-gray-700"><div class="block w-full"><div class="w-full text-center text-lg font-semibold">Show me everything!</div><div class="w-full text-center text-sm">Oh yeah, coding time.</div></div></label></li><li><input type=radio id=hide-code name=code-toggle value=hide-code class="hidden peer" onchange=clickCheckbox(this)>
<label for=hide-code class="inline-flex justify-between items-center p-5 w-full text-gray-500 bg-gray-800 rounded-lg border border-gray-200 cursor-pointer peer-checked:border-2 peer-checked:border-main-300 peer-checked:text-white peer-checked:bg-gray-700 hover:text-gray-200 hover:bg-gray-700"><div class="block w-full"><div class="w-full text-center text-lg font-semibold">Just the plots</div><div class="w-full text-center text-sm">Code is nasty.</div></div></label></li></ul></div><script>function clickCheckbox(e){e.id=="show-code"?document.getElementById("post-container").classList.remove("hide-code"):document.getElementById("post-container").classList.add("hide-code")}</script><p>For those reading this, I assume you know what Royal Road is. For those may have misclicked: it&rsquo;s a website where authors publish web serials, generally a chapter at a time, and generally at a freakishly fast pace (like one chapter a day). It&rsquo;s home to many greats in the Progression Fantasy / LitRPG genre, and I have spent hundreds of hours as a consumer of these serials.</p><p>So I decided to try and extract some insights from Royal Road data about how page count, followers, ratings, etc, impact the serials success and patreon conversion.</p><h1 id=tldr>TL;DR</h1><p><a href=#plotting><strong>Click here for the plots</strong></a></p><p><a href=#summary><strong>Click here for the final conclusions</strong></a></p><h2 id=scraping-data>Scraping data</h2><ol><li>Go through the latest updates, and grab a huge amount of story links using <code>requests</code> and <code>beautifulsoup4</code></li><li>Open each of them, using file caching because this might take a while. Grab their statistics, and Patreon if they have one.</li><li>Cry when this takes forever.</li></ol><div class=width-73 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>import</span> asyncio
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> json
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> pathlib <span style=color:#ff6ac1>import</span> Path
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> re
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> typing <span style=color:#ff6ac1>import</span> Iterable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> bs4 <span style=color:#ff6ac1>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> httpx
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib.pyplot <span style=color:#ff6ac1>as</span> plt
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> mpl_toolkits.axes_grid1 <span style=color:#ff6ac1>import</span> make_axes_locatable
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> numpy <span style=color:#ff6ac1>as</span> np
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> pandas <span style=color:#ff6ac1>as</span> pd
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> scipy.interpolate <span style=color:#ff6ac1>import</span> interp1d
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> seaborn <span style=color:#ff6ac1>as</span> sb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>client <span style=color:#ff6ac1>=</span> httpx<span style=color:#ff6ac1>.</span>AsyncClient()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>launch</span>(all_args: <span style=color:#ff5c57>list</span>[<span style=color:#ff5c57>str</span>], func, batch: <span style=color:#ff5c57>int</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>20</span>):
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;&#34;&#34;To speed things up, heres a concurrent batch async html fetcher&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    i <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0</span>
</span></span><span style=display:flex><span>    resps <span style=color:#ff6ac1>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> i <span style=color:#ff6ac1>&lt;</span> <span style=color:#ff5c57>len</span>(all_args):
</span></span><span style=display:flex><span>        <span style=color:#ff5c57>print</span>(i, end<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34; &#34;</span>)
</span></span><span style=display:flex><span>        args <span style=color:#ff6ac1>=</span> all_args[i:i<span style=color:#ff6ac1>+</span>batch]
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>            resps <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> asyncio<span style=color:#ff6ac1>.</span>gather(<span style=color:#ff6ac1>*</span><span style=color:#ff5c57>map</span>(func, args))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>except</span> Exception <span style=color:#ff6ac1>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff5c57>print</span>(e)
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>                resps <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> asyncio<span style=color:#ff6ac1>.</span>gather(<span style=color:#ff6ac1>*</span><span style=color:#ff5c57>map</span>(func, args))
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>except</span> Exception <span style=color:#ff6ac1>as</span> e:
</span></span><span style=display:flex><span>                <span style=color:#ff5c57>print</span>(e)
</span></span><span style=display:flex><span>        i <span style=color:#ff6ac1>+=</span> batch
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> resps
</span></span></code></pre></div></div><div class="expanded-code width-95" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># This was run as of 2022-10-15</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_last_updates</span>(page<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>list</span>[<span style=color:#ff5c57>str</span>]:
</span></span><span style=display:flex><span>    url <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;https://www.royalroad.com/fictions/latest-updates?page=</span><span style=color:#5af78e>{</span>page<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Fetch the HTML</span>
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(url)
</span></span><span style=display:flex><span>    <span style=color:#78787e># Parse it into a useful object</span>
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#78787e># And now extract links to each serial</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> [a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>] <span style=color:#ff6ac1>for</span> a <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.fiction-title a&#34;</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pages <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>list</span>(<span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>1</span>, <span style=color:#ff9f43>501</span>))
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(pages, get_last_updates, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Fetch things again, because if anyone updated while we were fetching, they would change pages</span>
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> launch(pages, get_last_updates, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> [l <span style=color:#ff6ac1>for</span> links <span style=color:#ff6ac1>in</span> all_links <span style=color:#ff6ac1>for</span> l <span style=color:#ff6ac1>in</span> links]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>with</span> <span style=color:#ff5c57>open</span>(<span style=color:#5af78e>&#34;royal_road/list.json&#34;</span>, <span style=color:#5af78e>&#34;w&#34;</span>) <span style=color:#ff6ac1>as</span> f:
</span></span><span style=display:flex><span>    json<span style=color:#ff6ac1>.</span>dump(all_links, f)
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>list</span>(<span style=color:#ff5c57>set</span>(all_links))
</span></span></code></pre></div></div><div class="reduced-code width-47" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff5c57>print</span>(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;Have </span><span style=color:#5af78e>{</span><span style=color:#ff5c57>len</span>(all_links)<span style=color:#5af78e>}</span><span style=color:#5af78e> stories to get.&#34;</span>)
</span></span></code></pre></div></div><pre><code>Have 8879 stories to get.
</code></pre><p>Now that we have all the links, next step: getting the stats.</p><p><strong>BIG CAVEAT:</strong> To make sure I don&rsquo;t just get the most popular releases, I&rsquo;m going through the latest releases. However, that means I don&rsquo;t expect to pick up finished works like Mother of Learning in these stats. Also, RR does not make the &ldquo;Last Chapter Published Date&rdquo; easy to find at all, so I&rsquo;m not storing that information. I expect works on Hiatus to have a larger Patreon drop, but will be hard to see from this info.</p><div class="expanded-code width-108" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># To help with iteration later, ignore this</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>pairwise</span>(iterable: Iterable) <span style=color:#ff6ac1>-&gt;</span> Iterable:
</span></span><span style=display:flex><span>    a <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>iter</span>(iterable)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> <span style=color:#ff5c57>zip</span>(a, a)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_plink</span>(plink):
</span></span><span style=display:flex><span>    <span style=color:#78787e># Alas some of the patreon links people have put cause redirects... so got to fix those</span>
</span></span><span style=display:flex><span>    plink <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;&amp;&#34;</span>, <span style=color:#5af78e>&#34;?&#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;https://patreon&#34;</span>, <span style=color:#5af78e>&#34;https://www.patreon&#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;user=&#34;</span>, <span style=color:#5af78e>&#34;u=&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon.com&#34;</span> <span style=color:#ff6ac1>not</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>None</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;?&#34;</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>        base <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;?&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;u=&#34;</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>            user <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;u=&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>1</span>]<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;?&#34;</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>            base <span style=color:#ff6ac1>+=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;?u=</span><span style=color:#5af78e>{</span>user<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>return</span> base
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> plink
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_stats_for_serial</span>(link: <span style=color:#ff5c57>str</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>dict</span>:
</span></span><span style=display:flex><span>    url <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;https://www.royalroad.com</span><span style=color:#5af78e>{</span>link<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(url)
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    stats_block <span style=color:#ff6ac1>=</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.fiction-stats .stats-content&#34;</span>, limit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    stats <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;link&#34;</span>: url, 
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;title&#34;</span>: soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;meta [name=&#34;twitter:title&#34;]&#39;</span>)[<span style=color:#ff9f43>0</span>]<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;content&#34;</span>], 
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;author&#34;</span>: soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;meta [name=&#34;twitter:creator&#34;]&#39;</span>)[<span style=color:#ff9f43>0</span>]<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extract the metadata hints behind the stars</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> meta <span style=color:#ff6ac1>in</span> stats_block<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;meta&#34;</span>):
</span></span><span style=display:flex><span>        attrs <span style=color:#ff6ac1>=</span> meta<span style=color:#ff6ac1>.</span>attrs
</span></span><span style=display:flex><span>        stats[attrs[<span style=color:#5af78e>&#34;property&#34;</span>]] <span style=color:#ff6ac1>=</span> attrs[<span style=color:#5af78e>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extract the human readable statistics (super flaky)</span>
</span></span><span style=display:flex><span>    styled <span style=color:#ff6ac1>=</span> stats_block<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.list-unstyled li&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> title, stat <span style=color:#ff6ac1>in</span> pairwise(styled):
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> <span style=color:#ff6ac1>not</span> stat<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>strip():
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>continue</span>
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>float</span>(stat<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;,&#34;</span>,<span style=color:#5af78e>&#34;&#34;</span>)<span style=color:#ff6ac1>.</span>strip())
</span></span><span style=display:flex><span>        key <span style=color:#ff6ac1>=</span> title<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;:&#34;</span>, <span style=color:#5af78e>&#34;&#34;</span>)<span style=color:#ff6ac1>.</span>strip()
</span></span><span style=display:flex><span>        stats[key] <span style=color:#ff6ac1>=</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># And grab patreon if we can</span>
</span></span><span style=display:flex><span>    patreon_links <span style=color:#ff6ac1>=</span> [a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>] <span style=color:#ff6ac1>for</span> a <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>find_all(<span style=color:#5af78e>&#34;a&#34;</span>, href<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>) <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon&#34;</span> <span style=color:#ff6ac1>in</span> a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>]]
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> patreon_links:
</span></span><span style=display:flex><span>        plink <span style=color:#ff6ac1>=</span> get_plink(patreon_links[<span style=color:#ff9f43>0</span>])
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> plink <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>not</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>            stats[<span style=color:#5af78e>&#34;patreon_link&#34;</span>] <span style=color:#ff6ac1>=</span> plink
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> stats
</span></span></code></pre></div></div><p>Whew, what a nightmare. If only Royal Road had an official API. If it <em>does</em>&mldr; and I&rsquo;ve missed it&mldr; don&rsquo;t tell me. This too too long and I no longer want to know how much time I wasted.</p><p>Anyway, we can run this to get first all RoyalRoad stats, and then gather all the patreon links and gather that data too.</p><div class="reduced-code width-57" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># This gets the RR stats</span>
</span></span><span style=display:flex><span>all_stats <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(all_links, get_stats_for_serial)
</span></span></code></pre></div></div><p>Alright, the patreon stats is a bit easier, because we can filter for data-tags right away.</p><div class="expanded-code width-85" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_patreon_stats</span>(link: <span style=color:#ff5c57>str</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>dict</span>[<span style=color:#ff5c57>str</span>, <span style=color:#ff5c57>float</span>]:
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(link)
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extra everything using the data-tag and h2 below it</span>
</span></span><span style=display:flex><span>    page_stats <span style=color:#ff6ac1>=</span> [x <span style=color:#ff6ac1>for</span> x <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;[data-tag*=&#34;Stats&#34;]&#39;</span>)]
</span></span><span style=display:flex><span>    stats <span style=color:#ff6ac1>=</span> {<span style=color:#5af78e>&#34;patreon_link&#34;</span>: link}
</span></span><span style=display:flex><span>    expr <span style=color:#ff6ac1>=</span> re<span style=color:#ff6ac1>.</span>compile(<span style=color:#5af78e>r</span><span style=color:#5af78e>&#34;[\d\.]&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> d <span style=color:#ff6ac1>in</span> page_stats:
</span></span><span style=display:flex><span>        key <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;&#34;</span><span style=color:#ff6ac1>.</span>join(d<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;data-tag&#34;</span>]<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;-&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>1</span>:])
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> d<span style=color:#ff6ac1>.</span>find(<span style=color:#5af78e>&#34;h2&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> value <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>continue</span>
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>float</span>(<span style=color:#5af78e>&#34;&#34;</span><span style=color:#ff6ac1>.</span>join(expr<span style=color:#ff6ac1>.</span>findall(value<span style=color:#ff6ac1>.</span>text)))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> key<span style=color:#ff6ac1>.</span>lower() <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#34;earnings&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#78787e># Ill save out USD as of todays conversion, AUD is probably not as useful</span>
</span></span><span style=display:flex><span>            value <span style=color:#ff6ac1>*=</span> <span style=color:#ff9f43>0.681642</span>
</span></span><span style=display:flex><span>        stats[key] <span style=color:#ff6ac1>=</span>value
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> stats
</span></span></code></pre></div></div><div class=width-70 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Separate out patreon stats</span>
</span></span><span style=display:flex><span>stats_w_patreon <span style=color:#ff6ac1>=</span> [s <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> all_stats <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon_link&#34;</span> <span style=color:#ff6ac1>in</span> s]
</span></span><span style=display:flex><span>urls_patreon <span style=color:#ff6ac1>=</span> [s[<span style=color:#5af78e>&#34;patreon_link&#34;</span>] <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> stats_w_patreon]
</span></span><span style=display:flex><span>urls_patreon <span style=color:#ff6ac1>=</span> [s <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> urls_patreon <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;www.patreon.com&#34;</span> <span style=color:#ff6ac1>in</span> s]
</span></span><span style=display:flex><span>patreon_stats <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(urls_patreon, get_patreon_stats, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span></code></pre></div></div><div class="expanded-code width-88" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Turn this into a dataframe, and save it out. </span>
</span></span><span style=display:flex><span>save_dir <span style=color:#ff6ac1>=</span> Path(<span style=color:#5af78e>&#34;royal_road&#34;</span>)
</span></span><span style=display:flex><span>save_dir<span style=color:#ff6ac1>.</span>mkdir(parents<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, exist_ok<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df_stats <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>DataFrame(all_stats)<span style=color:#ff6ac1>.</span>drop(columns<span style=color:#ff6ac1>=</span>[<span style=color:#5af78e>&#34;bestRating&#34;</span>, <span style=color:#5af78e>&#34;ratingCount&#34;</span>])
</span></span><span style=display:flex><span>df_patreon <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>DataFrame(patreon_stats)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df_stats<span style=color:#ff6ac1>.</span>merge(df_patreon, on<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;patreon_link&#34;</span>, how<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;left&#34;</span>)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>rename(columns<span style=color:#ff6ac1>=</span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;ratingValue&#34;</span>: <span style=color:#5af78e>&#34;Rating&#34;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>columns <span style=color:#ff6ac1>=</span> [x<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#39;_&#39;</span>, <span style=color:#5af78e>&#34; &#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;-&#34;</span>, <span style=color:#5af78e>&#34; &#34;</span>)<span style=color:#ff6ac1>.</span>title() <span style=color:#ff6ac1>for</span> x <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>columns]
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>sort_values([<span style=color:#5af78e>&#34;Followers&#34;</span>,  <span style=color:#5af78e>&#34;Patron Count&#34;</span>], ascending<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>drop_duplicates(subset<span style=color:#ff6ac1>=</span>[<span style=color:#5af78e>&#34;Title&#34;</span>, <span style=color:#5af78e>&#34;Author&#34;</span>], keep<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;first&#34;</span>)<span style=color:#ff6ac1>.</span>reset_index(drop<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Actually for some reason some of these explicit floats are being turned into strings?</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>for</span> c <span style=color:#ff6ac1>in</span> df:
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>        df[c] <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>to_numeric(df[c])
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>pass</span>
</span></span><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>to_csv(save_dir <span style=color:#ff6ac1>/</span> <span style=color:#5af78e>&#34;stats.csv&#34;</span>, index<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)
</span></span></code></pre></div></div><p>Alright, so let&rsquo;s grab the top 25 stories, ranked by number of followers.</p><div class=width-71 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>25</span>)[[<span style=color:#5af78e>&#34;Title&#34;</span>, <span style=color:#5af78e>&#34;Author&#34;</span>, <span style=color:#5af78e>&#34;Followers&#34;</span>, <span style=color:#5af78e>&#34;Rating&#34;</span>, <span style=color:#5af78e>&#34;Patron Count&#34;</span>]]
</span></span></code></pre></div></div><div><table class="table-auto table dataframe"><thead><tr style=text-align:right><th></th><th>Title</th><th>Author</th><th>Followers</th><th>Rating</th><th>Patron Count</th></tr></thead><tbody><tr><th>0</th><td>Beware Of Chicken</td><td>Casualfarmer</td><td>28543.0</td><td>4.779845</td><td>3971.0</td></tr><tr><th>1</th><td>Azarinth Healer</td><td>Rhaegar</td><td>23429.0</td><td>4.653555</td><td>3031.0</td></tr><tr><th>2</th><td>He Who Fights With Monsters</td><td>Shirtaloon (Travis Deverell)</td><td>19984.0</td><td>4.496575</td><td>6932.0</td></tr><tr><th>3</th><td>The Primal Hunter</td><td>Zogarth</td><td>19511.0</td><td>4.561625</td><td>3824.0</td></tr><tr><th>4</th><td>Paranoid Mage</td><td>InadvisablyCompelled</td><td>18470.0</td><td>4.740195</td><td>2390.0</td></tr><tr><th>5</th><td>Delve</td><td>SenescentSoul</td><td>18291.0</td><td>4.494240</td><td>1816.0</td></tr><tr><th>6</th><td>Defiance of the Fall</td><td>TheFirstDefier</td><td>15283.0</td><td>4.448760</td><td>3866.0</td></tr><tr><th>7</th><td>Mark of the Fool</td><td>J.M. Clarke (U Juggernaut)</td><td>14415.0</td><td>4.587905</td><td>993.0</td></tr><tr><th>8</th><td>There is no Epic Loot here, Only Puns.</td><td>stewart92</td><td>14254.0</td><td>4.698535</td><td>949.0</td></tr><tr><th>9</th><td>Salvos (A Monster Evolution LitRPG)</td><td>MelasDelta</td><td>14088.0</td><td>4.570255</td><td>1186.0</td></tr><tr><th>10</th><td>Beneath the Dragoneye Moons</td><td>Selkie</td><td>13668.0</td><td>4.516565</td><td>3338.0</td></tr><tr><th>11</th><td>Chrysalis</td><td>RinoZ</td><td>13636.0</td><td>4.576400</td><td>1365.0</td></tr><tr><th>12</th><td>The Path of Ascension</td><td>C_Mantis</td><td>12491.0</td><td>4.528735</td><td>1903.0</td></tr><tr><th>13</th><td>Vainqueur the Dragon</td><td>Maxime J. Durand (Void Herald)</td><td>12394.0</td><td>4.716280</td><td>464.0</td></tr><tr><th>14</th><td>Sylver Seeker</td><td>Kennit Kenway</td><td>12326.0</td><td>4.543540</td><td>NaN</td></tr><tr><th>15</th><td>Blue Core</td><td>InadvisablyCompelled</td><td>12253.0</td><td>4.616485</td><td>2390.0</td></tr><tr><th>16</th><td>The New World</td><td>Monsoon117</td><td>11964.0</td><td>4.460275</td><td>463.0</td></tr><tr><th>17</th><td>The Runesmith</td><td>Kuropon</td><td>11501.0</td><td>4.277465</td><td>567.0</td></tr><tr><th>18</th><td>Forge of Destiny</td><td>Yrsillar</td><td>11469.0</td><td>4.607040</td><td>418.0</td></tr><tr><th>19</th><td>The Calamitous Bob</td><td>Mecanimus</td><td>11209.0</td><td>4.733860</td><td>2027.0</td></tr><tr><th>20</th><td>Jackal Among Snakes</td><td>Nemorosus</td><td>11144.0</td><td>4.710550</td><td>805.0</td></tr><tr><th>21</th><td>Metaworld Chronicles</td><td>Wutosama</td><td>11050.0</td><td>4.541275</td><td>NaN</td></tr><tr><th>22</th><td>Tree of Aeons (An isekai story)</td><td>spaizzzer</td><td>10926.0</td><td>4.517970</td><td>819.0</td></tr><tr><th>23</th><td>A Journey of Black and Red</td><td>Mecanimus</td><td>10643.0</td><td>4.750410</td><td>2027.0</td></tr><tr><th>24</th><td>The Essence of Cultivation</td><td>Agranulocytosis</td><td>10546.0</td><td>4.727825</td><td>NaN</td></tr></tbody></table></div><p>If you want the csv data, <a href=https://gist.github.com/Samreay/93ed90bca741694095ec0cb07e1547b2>I&rsquo;ve uploaded it to here</a>.</p><h2 id=plotting>Plotting</h2><p>Alright, so we have our dataframe, which means we can now get to plotting.</p><p>Let&rsquo;s just have a quick look at the distribution of Followers, because I imagine most stories are pretty much dead on arrival.</p><div class="expanded-code width-91" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_hist</span>(df, col, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.9</span>, <span style=color:#ff9f43>0.99</span>], bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>50</span>, xlim<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>None</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.0f</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff6ac1>**</span>kw):
</span></span><span style=display:flex><span>    _, ax <span style=color:#ff6ac1>=</span> plt<span style=color:#ff6ac1>.</span>subplots()
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> xlim <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>        xlim <span style=color:#ff6ac1>=</span> (df[col]<span style=color:#ff6ac1>.</span>min(), df[col]<span style=color:#ff6ac1>.</span>max())
</span></span><span style=display:flex><span>    y, x, _ <span style=color:#ff6ac1>=</span> ax<span style=color:#ff6ac1>.</span>hist(df[col], bins<span style=color:#ff6ac1>=</span>np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff6ac1>*</span>xlim, bins), <span style=color:#ff6ac1>**</span>kw)
</span></span><span style=display:flex><span>    xc <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0.5</span> <span style=color:#ff6ac1>*</span> (x[<span style=color:#ff9f43>1</span>:] <span style=color:#ff6ac1>+</span> x[:<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1</span>])
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> quantiles:
</span></span><span style=display:flex><span>        interp <span style=color:#ff6ac1>=</span> interp1d(xc, y, bounds_error<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>, fill_value<span style=color:#ff6ac1>=</span>(y[<span style=color:#ff9f43>0</span>], y[<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1</span>]))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>for</span> q, q_val <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>zip</span>(quantiles, df[col]<span style=color:#ff6ac1>.</span>quantile(quantiles)):
</span></span><span style=display:flex><span>            qstr <span style=color:#ff6ac1>=</span> qfmt <span style=color:#ff6ac1>%</span> q_val
</span></span><span style=display:flex><span>            qy <span style=color:#ff6ac1>=</span> interp(q_val) <span style=color:#ff6ac1>+</span> <span style=color:#ff9f43>0.03</span> <span style=color:#ff6ac1>*</span> y<span style=color:#ff6ac1>.</span>max()
</span></span><span style=display:flex><span>            ax<span style=color:#ff6ac1>.</span>axvline(q_val, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.5</span>, ls<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;:&#34;</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)
</span></span><span style=display:flex><span>            ax<span style=color:#ff6ac1>.</span>annotate(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>{</span><span style=color:#ff9f43>1</span><span style=color:#ff6ac1>-</span>q<span style=color:#5af78e>:</span><span style=color:#5af78e>0.0%</span><span style=color:#5af78e>}</span><span style=color:#5af78e> &gt; </span><span style=color:#5af78e>{</span>qstr<span style=color:#5af78e>}</span><span style=color:#5af78e> </span><span style=color:#5af78e>{</span>col<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>, (q_val, qy))
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlim(<span style=color:#ff6ac1>*</span>xlim)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlabel(col)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>plot_hist(df, <span style=color:#5af78e>&#34;Followers&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>500</span>, xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>6000</span>))
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_17_0_hu978ec99647119df5e0416533d5dfe6b2_148227_1920x0_resize_q90_h2_box_3.webp width=1920 height=972 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_17_0.png width=5378 height=2722 type=image/png><img width=5378 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Let&rsquo;s zoom in on this distribution&mldr;</p><div class=width-79 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plot_hist(df, <span style=color:#5af78e>&#34;Followers&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.75</span>, <span style=color:#ff9f43>0.8</span>], xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>100</span>))
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_19_0_hu16eae23c73726312427a2bfc25253732_138167_1920x0_resize_q90_h2_box_3.webp width=1920 height=977 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_19_0.png width=5349 height=2722 type=image/png><img width=5349 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Ouch. So the majority of serials have essentially no followers. The median number of followers is 4. If you break 330, you&rsquo;re in the top 10%. You&rsquo;ll need around 5000 for the top 1%.</p><div class=width-69 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_established</span>(df: pd<span style=color:#ff6ac1>.</span>DataFrame, threshold<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>) <span style=color:#ff6ac1>-&gt;</span> pd<span style=color:#ff6ac1>.</span>DataFrame:
</span></span><span style=display:flex><span>    df <span style=color:#ff6ac1>=</span> df[df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>&gt;</span> threshold]<span style=color:#ff6ac1>.</span>copy()
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Patron Value&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Earnings&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Patron Count&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Patron Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Patron Count&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Favourite Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Favorites&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Follow Rate (Total)&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Total Views&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Follow Rate (Avg)&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Average Views&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Rating Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Ratings&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> df
</span></span><span style=display:flex><span>df_established <span style=color:#ff6ac1>=</span> get_established(df)
</span></span></code></pre></div></div><p>I&rsquo;m going to filter out a lot of stories with 100 followers when making some distributions, just because we need enough followers to get some good statistics like a converged average rating.</p><div class="expanded-code width-82" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Use correlation to show pages and rating are the weakest indicators of Followers</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_cor</span>(df):
</span></span><span style=display:flex><span>    cor <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>corr(numeric_only<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>    ax <span style=color:#ff6ac1>=</span> sb<span style=color:#ff6ac1>.</span>heatmap(cor, square<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_title(<span style=color:#5af78e>&#34;Correlations&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>plot_cor(df_established)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_23_0_hude6a1cb44930592271f9e54439a75c6f_382181_1920x0_resize_q90_h2_box_3.webp width=1920 height=1710 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_23_0.png width=3911 height=3483 type=image/png><img width=3911 height=3483 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Obviously we expect most of these correlations. The more views you have, the more followers, means the more favourites, and the more ratings. And the more patrons, the higher your earnings, of course. Interestingly, page count does very little, along with Rating. So those aren&rsquo;t significant barriers to entry, rejoice those who have been review bombed!</p><div class="reduced-code width-58" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Look into avergae profit per patreon</span>
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Rating&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>40</span>)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_25_0_hud745b06af3856138701c9dc42bfd00f6_137551_1920x0_resize_q90_h2_box_3.webp width=1920 height=903 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_25_0.png width=5787 height=2722 type=image/png><img width=5787 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>The standard 4.5 stars distribution seen everywhere with a 5 star rating system.</p><div class="reduced-code width-57" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Favourite Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_27_0_huaa7eb05b4878cc03f7af934944345e38_151466_1920x0_resize_q90_h2_box_3.webp width=1920 height=998 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_27_0.png width=5235 height=2722 type=image/png><img width=5235 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>So for every 100 followers, the median story gains 24 favourites.</p><div class="reduced-code width-54" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Rating Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_29_0_hu2e207c36168156c4d04e45802f3d1ac0_147597_1920x0_resize_q90_h2_box_3.webp width=1920 height=998 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_29_0.png width=5235 height=2722 type=image/png><img width=5235 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Looks like a similar story for the ratings. Median conversion of 23% from follow to a rating.</p><div class=width-69 markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Follow Rate (Avg)&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>80</span>)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_31_0_hu2483bebdc7ace40a44c6e0666233b7a3_170792_1920x0_resize_q90_h2_box_3.webp width=1920 height=998 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_31_0.png width=5235 height=2722 type=image/png><img width=5235 height=2722 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>This is a bit harder to interpet, because I don&rsquo;t believe RR is giving us a total number of unique visitors (indeed its hard to determine that number without browser fingerprinting anyway). So instead we have the average views per chapter, and I&rsquo;m curious how this translates into the number of followers. Note, I don&rsquo;t have the average number of followers <em>per</em> chapter, which would be a much better bit of data. So the plot above, in my mind, is almost useless. But what it does (maybe) show is that if an author gets 10k views per chapter, the median would have that translate into a story with 2.9k followers.</p><p>I also expect the above to be highly dependent on hiatus and gaps in the story, but again, don&rsquo;t have the data. Frustrated there&rsquo;s no official API.</p><div class="expanded-code width-99" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Covnersion between Followers/Favourites to Patreon count&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_prate</span>(df):
</span></span><span style=display:flex><span>    <span style=color:#78787e># Have to group authors with multiple stories leading to same patreon</span>
</span></span><span style=display:flex><span>    df2 <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>groupby(<span style=color:#5af78e>&#34;Patreon Link&#34;</span>)<span style=color:#ff6ac1>.</span>sum(numeric_only<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)<span style=color:#ff6ac1>.</span>reset_index()
</span></span><span style=display:flex><span>    df2 <span style=color:#ff6ac1>=</span> df2[df2[<span style=color:#5af78e>&#34;Patron Rate&#34;</span>] <span style=color:#ff6ac1>&lt;</span> <span style=color:#ff9f43>1.0</span>]<span style=color:#ff6ac1>.</span>copy()
</span></span><span style=display:flex><span>    plot_hist(df2, <span style=color:#5af78e>&#34;Patron Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.3f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>, xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>0.5</span>), quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.7</span>, <span style=color:#ff9f43>0.9</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plot_prate(df_established)
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_33_0_hu3b0073e76eb5cfe4c095e0be15b4cd2f_126767_1920x0_resize_q90_h2_box_3.webp width=1920 height=802 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_33_0.png width=5394 height=2253 type=image/png><img width=5394 height=2253 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>The higher conversion rate numbers might be unreliable. This assumes that the RR stories I&rsquo;ve found are the only funnels into Patreon, and this might not be correct, especially for stories which are also released in other locations.</p><div class="expanded-code width-99" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e># Curious about the average value of each patron</span>
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Patron Value&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;$</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>55</span>, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.75</span>, <span style=color:#ff9f43>0.9</span>, <span style=color:#ff9f43>0.99</span>])
</span></span></code></pre></div></div><p><div><figure class=rounded><picture><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_35_0_hu701d41cd28151f20b6ad0b17950f4618_156490_1920x0_resize_q90_h2_box_3.webp width=1920 height=821 type=image/webp><source srcset=/tutorials/royalroad/2022-10-14-RoyalRoad_files/2022-10-14-RoyalRoad_35_0.png width=5266 height=2253 type=image/png><img width=5266 height=2253 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>As a caveat, not all patreons have their income public, so this is only using that subset where we have both income and number of patrons.</p><div class="expanded-code width-111" markdown=1><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#78787e>#Create overview plot</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_overview</span>(df, ax, fig):
</span></span><span style=display:flex><span>    x <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Rating&#34;</span>]
</span></span><span style=display:flex><span>    y <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    c <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Pages&#34;</span>]
</span></span><span style=display:flex><span>    s <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>20</span>
</span></span><span style=display:flex><span>    h <span style=color:#ff6ac1>=</span> ax<span style=color:#ff6ac1>.</span>scatter(x, y, c<span style=color:#ff6ac1>=</span>c, s<span style=color:#ff6ac1>=</span>s, cmap<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jet&#34;</span>, norm<span style=color:#ff6ac1>=</span>matplotlib<span style=color:#ff6ac1>.</span>colors<span style=color:#ff6ac1>.</span>LogNorm(vmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>50</span>, vmax<span style=color:#ff6ac1>=</span>c<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>1.2</span>),)
</span></span><span style=display:flex><span>    divider <span style=color:#ff6ac1>=</span> make_axes_locatable(ax)
</span></span><span style=display:flex><span>    cax <span style=color:#ff6ac1>=</span> divider<span style=color:#ff6ac1>.</span>append_axes(<span style=color:#5af78e>&#39;right&#39;</span>, size<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;2%&#39;</span>, pad<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.05</span>)
</span></span><span style=display:flex><span>    fig<span style=color:#ff6ac1>.</span>colorbar(h, cax<span style=color:#ff6ac1>=</span>cax, orientation<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;vertical&#39;</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Pages&#34;</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlim(<span style=color:#ff9f43>3</span>, x<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>1.04</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_ylim(y<span style=color:#ff6ac1>.</span>min(), <span style=color:#ff9f43>1.1</span> <span style=color:#ff6ac1>*</span> y<span style=color:#ff6ac1>.</span>max())
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlabel(<span style=color:#5af78e>&#34;Rating&#34;</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_ylabel(<span style=color:#5af78e>&#34;Followers&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    padding <span style=color:#ff6ac1>=</span> y<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>0.01</span>
</span></span><span style=display:flex><span>    replace <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;He Who Fights With Monsters&#34;</span>: <span style=color:#5af78e>&#34;HWFWM&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Salvos (A Monster Evolution LitRPG)&#34;</span>: <span style=color:#5af78e>&#34;Salvos&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Defiance of the Fall&#34;</span>: <span style=color:#5af78e>&#34;DotF&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;There is no Epic Loot here, Only Puns.&#34;</span>: <span style=color:#5af78e>&#34;Only Puns&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    offset <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;HWFWM&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.15</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;The Primal Hunter&#34;</span>: (<span style=color:#ff9f43>0.2</span>, <span style=color:#ff9f43>3</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Paranoid Mage&#34;</span>: (<span style=color:#ff9f43>0.22</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Delve&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.12</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Mark of the Fool&#34;</span>: (<span style=color:#ff9f43>0.15</span>, <span style=color:#ff9f43>1</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Salvos&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.15</span>, <span style=color:#ff9f43>0</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Only Puns&#34;</span>: (<span style=color:#ff9f43>0.15</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.3</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>annotate</span>(i, row):
</span></span><span style=display:flex><span>        t <span style=color:#ff6ac1>=</span> replace<span style=color:#ff6ac1>.</span>get(row[<span style=color:#5af78e>&#39;Title&#39;</span>], row[<span style=color:#5af78e>&#39;Title&#39;</span>])
</span></span><span style=display:flex><span>        o <span style=color:#ff6ac1>=</span> offset<span style=color:#ff6ac1>.</span>get(t, (<span style=color:#ff9f43>0</span>,<span style=color:#ff9f43>1</span>))
</span></span><span style=display:flex><span>        pos <span style=color:#ff6ac1>=</span> x[i], y[i]
</span></span><span style=display:flex><span>        arrow <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>dict</span>(arrowstyle<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;-&#34;</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.3</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.5</span>, shrinkA<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, shrinkB<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>3</span>) <span style=color:#ff6ac1>if</span> t <span style=color:#ff6ac1>in</span> offset <span style=color:#ff6ac1>else</span> <span style=color:#ff6ac1>None</span>
</span></span><span style=display:flex><span>        ax<span style=color:#ff6ac1>.</span>annotate(t, pos, (x[i] <span style=color:#ff6ac1>+</span> o[<span style=color:#ff9f43>0</span>], (padding <span style=color:#ff6ac1>*</span> o[<span style=color:#ff9f43>1</span>]) <span style=color:#ff6ac1>+</span> y[i]), va<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;bottom&#34;</span>, ha<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;center&#34;</span>, arrowprops<span style=color:#ff6ac1>=</span>arrow)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> i, row <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>10</span>)<span style=color:#ff6ac1>.</span>iterrows():
</span></span><span style=display:flex><span>        annotate(i, row) 
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> i, row <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>sort_values(<span style=color:#5af78e>&#34;Pages&#34;</span>, ascending<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>1</span>)<span style=color:#ff6ac1>.</span>iterrows():
</span></span><span style=display:flex><span>        annotate(i, row)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>fig, ax <span style=color:#ff6ac1>=</span> plt<span style=color:#ff6ac1>.</span>subplots(figsize<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>8</span>))
</span></span><span style=display:flex><span>plot_overview(df_established, ax, fig)
</span></span></code></pre></div></div><p><div><figure class="img-main img-poster rounded"><picture><source srcset=/tutorials/royalroad/cover_hu57fe328fe2e54cc9deb34da4a01ff0e0_765442_1920x0_resize_q90_h2_box_3.webp width=1920 height=1397 type=image/webp><source srcset=/tutorials/royalroad/cover.png width=5636 height=4101 type=image/png><img width=5636 height=4101 loading=lazy decoding=async alt=png src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mPMn7vLFAAFRgH97g1QygAAAABJRU5ErkJggg=="></picture></figure></div></p><p>Savage Divinity with that monstrous word count. If only The Wandering Inn was on RR, it would destroy everything. But apart from that, notice how asymmetric this distribution is, and how the higher follower stories shift higher in the ratings as well.</p><h2 id=summary>Summary</h2><p>Interesting things we note:</p><ol><li>Page count nor rating is useful in predicing followers, or income.</li><li>In general, the more Followers you get, your average rating will be higher. This is probably just the fact you can average out rating bombs if you have enough people.</li><li>Typically about 30% of Followers will leave a rating.</li><li>Its hard to get Patreon conversion, 2% is the median, and even the top 10% aren&rsquo;t breaking 20%.</li><li>However, each conversion represents about 5USD, which is nice.</li><li>Beware of Chicken is absolutely <em>crushing</em> the Follower count.</li><li>The grind for new stories is horrific. 50% of stories updated in the last 6 months have four followers or less. The top ten percent are only in aruond 300, which isn&rsquo;t enough for a proper readership and career swap. The top 1% get around 5000 followers.</li><li>If you&rsquo;re above 4.4 stars, you&rsquo;re above average.</li></ol><hr><p>For your convenience, here&rsquo;s the code in one block:</p><div class=highlight><pre tabindex=0 style=color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ff6ac1>import</span> asyncio
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> json
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> pathlib <span style=color:#ff6ac1>import</span> Path
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> re
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> typing <span style=color:#ff6ac1>import</span> Iterable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> bs4 <span style=color:#ff6ac1>import</span> BeautifulSoup
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> httpx
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> matplotlib.pyplot <span style=color:#ff6ac1>as</span> plt
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> mpl_toolkits.axes_grid1 <span style=color:#ff6ac1>import</span> make_axes_locatable
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> numpy <span style=color:#ff6ac1>as</span> np
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> pandas <span style=color:#ff6ac1>as</span> pd
</span></span><span style=display:flex><span><span style=color:#ff6ac1>from</span> scipy.interpolate <span style=color:#ff6ac1>import</span> interp1d
</span></span><span style=display:flex><span><span style=color:#ff6ac1>import</span> seaborn <span style=color:#ff6ac1>as</span> sb
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>client <span style=color:#ff6ac1>=</span> httpx<span style=color:#ff6ac1>.</span>AsyncClient()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>launch</span>(all_args: <span style=color:#ff5c57>list</span>[<span style=color:#ff5c57>str</span>], func, batch: <span style=color:#ff5c57>int</span> <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>20</span>):
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;&#34;&#34;To speed things up, heres a concurrent batch async html fetcher&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    i <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0</span>
</span></span><span style=display:flex><span>    resps <span style=color:#ff6ac1>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>while</span> i <span style=color:#ff6ac1>&lt;</span> <span style=color:#ff5c57>len</span>(all_args):
</span></span><span style=display:flex><span>        <span style=color:#ff5c57>print</span>(i, end<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34; &#34;</span>)
</span></span><span style=display:flex><span>        args <span style=color:#ff6ac1>=</span> all_args[i:i<span style=color:#ff6ac1>+</span>batch]
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>            resps <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> asyncio<span style=color:#ff6ac1>.</span>gather(<span style=color:#ff6ac1>*</span><span style=color:#ff5c57>map</span>(func, args))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>except</span> Exception <span style=color:#ff6ac1>as</span> e:
</span></span><span style=display:flex><span>            <span style=color:#ff5c57>print</span>(e)
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>                resps <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> asyncio<span style=color:#ff6ac1>.</span>gather(<span style=color:#ff6ac1>*</span><span style=color:#ff5c57>map</span>(func, args))
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>except</span> Exception <span style=color:#ff6ac1>as</span> e:
</span></span><span style=display:flex><span>                <span style=color:#ff5c57>print</span>(e)
</span></span><span style=display:flex><span>        i <span style=color:#ff6ac1>+=</span> batch
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> resps
</span></span><span style=display:flex><span><span style=color:#78787e># This was run as of 2022-10-15</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_last_updates</span>(page<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>list</span>[<span style=color:#ff5c57>str</span>]:
</span></span><span style=display:flex><span>    url <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;https://www.royalroad.com/fictions/latest-updates?page=</span><span style=color:#5af78e>{</span>page<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Fetch the HTML</span>
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(url)
</span></span><span style=display:flex><span>    <span style=color:#78787e># Parse it into a useful object</span>
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#78787e># And now extract links to each serial</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> [a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>] <span style=color:#ff6ac1>for</span> a <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.fiction-title a&#34;</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pages <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>list</span>(<span style=color:#ff5c57>range</span>(<span style=color:#ff9f43>1</span>, <span style=color:#ff9f43>501</span>))
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(pages, get_last_updates, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Fetch things again, because if anyone updated while we were fetching, they would change pages</span>
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>+=</span> <span style=color:#ff6ac1>await</span> launch(pages, get_last_updates, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> [l <span style=color:#ff6ac1>for</span> links <span style=color:#ff6ac1>in</span> all_links <span style=color:#ff6ac1>for</span> l <span style=color:#ff6ac1>in</span> links]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>with</span> <span style=color:#ff5c57>open</span>(<span style=color:#5af78e>&#34;royal_road/list.json&#34;</span>, <span style=color:#5af78e>&#34;w&#34;</span>) <span style=color:#ff6ac1>as</span> f:
</span></span><span style=display:flex><span>    json<span style=color:#ff6ac1>.</span>dump(all_links, f)
</span></span><span style=display:flex><span>all_links <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>list</span>(<span style=color:#ff5c57>set</span>(all_links))
</span></span><span style=display:flex><span><span style=color:#ff5c57>print</span>(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;Have </span><span style=color:#5af78e>{</span><span style=color:#ff5c57>len</span>(all_links)<span style=color:#5af78e>}</span><span style=color:#5af78e> stories to get.&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># To help with iteration later, ignore this</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>pairwise</span>(iterable: Iterable) <span style=color:#ff6ac1>-&gt;</span> Iterable:
</span></span><span style=display:flex><span>    a <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>iter</span>(iterable)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> <span style=color:#ff5c57>zip</span>(a, a)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_plink</span>(plink):
</span></span><span style=display:flex><span>    <span style=color:#78787e># Alas some of the patreon links people have put cause redirects... so got to fix those</span>
</span></span><span style=display:flex><span>    plink <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;&amp;&#34;</span>, <span style=color:#5af78e>&#34;?&#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;https://patreon&#34;</span>, <span style=color:#5af78e>&#34;https://www.patreon&#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;user=&#34;</span>, <span style=color:#5af78e>&#34;u=&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon.com&#34;</span> <span style=color:#ff6ac1>not</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>return</span> <span style=color:#ff6ac1>None</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;?&#34;</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>        base <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;?&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;u=&#34;</span> <span style=color:#ff6ac1>in</span> plink:
</span></span><span style=display:flex><span>            user <span style=color:#ff6ac1>=</span> plink<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;u=&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>1</span>]<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;?&#34;</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>            base <span style=color:#ff6ac1>+=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;?u=</span><span style=color:#5af78e>{</span>user<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>return</span> base
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> plink
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_stats_for_serial</span>(link: <span style=color:#ff5c57>str</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>dict</span>:
</span></span><span style=display:flex><span>    url <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;https://www.royalroad.com</span><span style=color:#5af78e>{</span>link<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(url)
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    stats_block <span style=color:#ff6ac1>=</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.fiction-stats .stats-content&#34;</span>, limit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    stats <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;link&#34;</span>: url, 
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;title&#34;</span>: soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;meta [name=&#34;twitter:title&#34;]&#39;</span>)[<span style=color:#ff9f43>0</span>]<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;content&#34;</span>], 
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;author&#34;</span>: soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;meta [name=&#34;twitter:creator&#34;]&#39;</span>)[<span style=color:#ff9f43>0</span>]<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extract the metadata hints behind the stars</span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> meta <span style=color:#ff6ac1>in</span> stats_block<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;meta&#34;</span>):
</span></span><span style=display:flex><span>        attrs <span style=color:#ff6ac1>=</span> meta<span style=color:#ff6ac1>.</span>attrs
</span></span><span style=display:flex><span>        stats[attrs[<span style=color:#5af78e>&#34;property&#34;</span>]] <span style=color:#ff6ac1>=</span> attrs[<span style=color:#5af78e>&#34;content&#34;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extract the human readable statistics (super flaky)</span>
</span></span><span style=display:flex><span>    styled <span style=color:#ff6ac1>=</span> stats_block<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#34;.list-unstyled li&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> title, stat <span style=color:#ff6ac1>in</span> pairwise(styled):
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> <span style=color:#ff6ac1>not</span> stat<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>strip():
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>continue</span>
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>float</span>(stat<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;,&#34;</span>,<span style=color:#5af78e>&#34;&#34;</span>)<span style=color:#ff6ac1>.</span>strip())
</span></span><span style=display:flex><span>        key <span style=color:#ff6ac1>=</span> title<span style=color:#ff6ac1>.</span>text<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;:&#34;</span>, <span style=color:#5af78e>&#34;&#34;</span>)<span style=color:#ff6ac1>.</span>strip()
</span></span><span style=display:flex><span>        stats[key] <span style=color:#ff6ac1>=</span> value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># And grab patreon if we can</span>
</span></span><span style=display:flex><span>    patreon_links <span style=color:#ff6ac1>=</span> [a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>] <span style=color:#ff6ac1>for</span> a <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>find_all(<span style=color:#5af78e>&#34;a&#34;</span>, href<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>) <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon&#34;</span> <span style=color:#ff6ac1>in</span> a<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;href&#34;</span>]]
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> patreon_links:
</span></span><span style=display:flex><span>        plink <span style=color:#ff6ac1>=</span> get_plink(patreon_links[<span style=color:#ff9f43>0</span>])
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> plink <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>not</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>            stats[<span style=color:#5af78e>&#34;patreon_link&#34;</span>] <span style=color:#ff6ac1>=</span> plink
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> stats
</span></span><span style=display:flex><span><span style=color:#78787e># This gets the RR stats</span>
</span></span><span style=display:flex><span>all_stats <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(all_links, get_stats_for_serial)
</span></span><span style=display:flex><span><span style=color:#ff6ac1>async</span> <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_patreon_stats</span>(link: <span style=color:#ff5c57>str</span>) <span style=color:#ff6ac1>-&gt;</span> <span style=color:#ff5c57>dict</span>[<span style=color:#ff5c57>str</span>, <span style=color:#ff5c57>float</span>]:
</span></span><span style=display:flex><span>    response <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> client<span style=color:#ff6ac1>.</span>get(link)
</span></span><span style=display:flex><span>    soup <span style=color:#ff6ac1>=</span> BeautifulSoup(response<span style=color:#ff6ac1>.</span>content, <span style=color:#5af78e>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#78787e># Extra everything using the data-tag and h2 below it</span>
</span></span><span style=display:flex><span>    page_stats <span style=color:#ff6ac1>=</span> [x <span style=color:#ff6ac1>for</span> x <span style=color:#ff6ac1>in</span> soup<span style=color:#ff6ac1>.</span>select(<span style=color:#5af78e>&#39;[data-tag*=&#34;Stats&#34;]&#39;</span>)]
</span></span><span style=display:flex><span>    stats <span style=color:#ff6ac1>=</span> {<span style=color:#5af78e>&#34;patreon_link&#34;</span>: link}
</span></span><span style=display:flex><span>    expr <span style=color:#ff6ac1>=</span> re<span style=color:#ff6ac1>.</span>compile(<span style=color:#5af78e>r</span><span style=color:#5af78e>&#34;[\d\.]&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> d <span style=color:#ff6ac1>in</span> page_stats:
</span></span><span style=display:flex><span>        key <span style=color:#ff6ac1>=</span> <span style=color:#5af78e>&#34;&#34;</span><span style=color:#ff6ac1>.</span>join(d<span style=color:#ff6ac1>.</span>attrs[<span style=color:#5af78e>&#34;data-tag&#34;</span>]<span style=color:#ff6ac1>.</span>split(<span style=color:#5af78e>&#34;-&#34;</span>, maxsplit<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)[<span style=color:#ff9f43>1</span>:])
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> d<span style=color:#ff6ac1>.</span>find(<span style=color:#5af78e>&#34;h2&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> value <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff6ac1>continue</span>
</span></span><span style=display:flex><span>        value <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>float</span>(<span style=color:#5af78e>&#34;&#34;</span><span style=color:#ff6ac1>.</span>join(expr<span style=color:#ff6ac1>.</span>findall(value<span style=color:#ff6ac1>.</span>text)))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>if</span> key<span style=color:#ff6ac1>.</span>lower() <span style=color:#ff6ac1>==</span> <span style=color:#5af78e>&#34;earnings&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#78787e># Ill save out USD as of todays conversion, AUD is probably not as useful</span>
</span></span><span style=display:flex><span>            value <span style=color:#ff6ac1>*=</span> <span style=color:#ff9f43>0.681642</span>
</span></span><span style=display:flex><span>        stats[key] <span style=color:#ff6ac1>=</span>value
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> stats
</span></span><span style=display:flex><span><span style=color:#78787e># Separate out patreon stats</span>
</span></span><span style=display:flex><span>stats_w_patreon <span style=color:#ff6ac1>=</span> [s <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> all_stats <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;patreon_link&#34;</span> <span style=color:#ff6ac1>in</span> s]
</span></span><span style=display:flex><span>urls_patreon <span style=color:#ff6ac1>=</span> [s[<span style=color:#5af78e>&#34;patreon_link&#34;</span>] <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> stats_w_patreon]
</span></span><span style=display:flex><span>urls_patreon <span style=color:#ff6ac1>=</span> [s <span style=color:#ff6ac1>for</span> s <span style=color:#ff6ac1>in</span> urls_patreon <span style=color:#ff6ac1>if</span> <span style=color:#5af78e>&#34;www.patreon.com&#34;</span> <span style=color:#ff6ac1>in</span> s]
</span></span><span style=display:flex><span>patreon_stats <span style=color:#ff6ac1>=</span> <span style=color:#ff6ac1>await</span> launch(urls_patreon, get_patreon_stats, batch<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>5</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Turn this into a dataframe, and save it out. </span>
</span></span><span style=display:flex><span>save_dir <span style=color:#ff6ac1>=</span> Path(<span style=color:#5af78e>&#34;royal_road&#34;</span>)
</span></span><span style=display:flex><span>save_dir<span style=color:#ff6ac1>.</span>mkdir(parents<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>, exist_ok<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df_stats <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>DataFrame(all_stats)<span style=color:#ff6ac1>.</span>drop(columns<span style=color:#ff6ac1>=</span>[<span style=color:#5af78e>&#34;bestRating&#34;</span>, <span style=color:#5af78e>&#34;ratingCount&#34;</span>])
</span></span><span style=display:flex><span>df_patreon <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>DataFrame(patreon_stats)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df_stats<span style=color:#ff6ac1>.</span>merge(df_patreon, on<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;patreon_link&#34;</span>, how<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;left&#34;</span>)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>rename(columns<span style=color:#ff6ac1>=</span>{
</span></span><span style=display:flex><span>    <span style=color:#5af78e>&#34;ratingValue&#34;</span>: <span style=color:#5af78e>&#34;Rating&#34;</span>
</span></span><span style=display:flex><span>})
</span></span><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>columns <span style=color:#ff6ac1>=</span> [x<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#39;_&#39;</span>, <span style=color:#5af78e>&#34; &#34;</span>)<span style=color:#ff6ac1>.</span>replace(<span style=color:#5af78e>&#34;-&#34;</span>, <span style=color:#5af78e>&#34; &#34;</span>)<span style=color:#ff6ac1>.</span>title() <span style=color:#ff6ac1>for</span> x <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>columns]
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>sort_values([<span style=color:#5af78e>&#34;Followers&#34;</span>,  <span style=color:#5af78e>&#34;Patron Count&#34;</span>], ascending<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)
</span></span><span style=display:flex><span>df <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>drop_duplicates(subset<span style=color:#ff6ac1>=</span>[<span style=color:#5af78e>&#34;Title&#34;</span>, <span style=color:#5af78e>&#34;Author&#34;</span>], keep<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;first&#34;</span>)<span style=color:#ff6ac1>.</span>reset_index(drop<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Actually for some reason some of these explicit floats are being turned into strings?</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>for</span> c <span style=color:#ff6ac1>in</span> df:
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>try</span>:
</span></span><span style=display:flex><span>        df[c] <span style=color:#ff6ac1>=</span> pd<span style=color:#ff6ac1>.</span>to_numeric(df[c])
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>except</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>pass</span>
</span></span><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>to_csv(save_dir <span style=color:#ff6ac1>/</span> <span style=color:#5af78e>&#34;stats.csv&#34;</span>, index<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)
</span></span><span style=display:flex><span>df<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>25</span>)[[<span style=color:#5af78e>&#34;Title&#34;</span>, <span style=color:#5af78e>&#34;Author&#34;</span>, <span style=color:#5af78e>&#34;Followers&#34;</span>, <span style=color:#5af78e>&#34;Rating&#34;</span>, <span style=color:#5af78e>&#34;Patron Count&#34;</span>]]
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_hist</span>(df, col, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.9</span>, <span style=color:#ff9f43>0.99</span>], bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>50</span>, xlim<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>None</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.0f</span><span style=color:#5af78e>&#34;</span>, <span style=color:#ff6ac1>**</span>kw):
</span></span><span style=display:flex><span>    _, ax <span style=color:#ff6ac1>=</span> plt<span style=color:#ff6ac1>.</span>subplots()
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> xlim <span style=color:#ff6ac1>is</span> <span style=color:#ff6ac1>None</span>:
</span></span><span style=display:flex><span>        xlim <span style=color:#ff6ac1>=</span> (df[col]<span style=color:#ff6ac1>.</span>min(), df[col]<span style=color:#ff6ac1>.</span>max())
</span></span><span style=display:flex><span>    y, x, _ <span style=color:#ff6ac1>=</span> ax<span style=color:#ff6ac1>.</span>hist(df[col], bins<span style=color:#ff6ac1>=</span>np<span style=color:#ff6ac1>.</span>linspace(<span style=color:#ff6ac1>*</span>xlim, bins), <span style=color:#ff6ac1>**</span>kw)
</span></span><span style=display:flex><span>    xc <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>0.5</span> <span style=color:#ff6ac1>*</span> (x[<span style=color:#ff9f43>1</span>:] <span style=color:#ff6ac1>+</span> x[:<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1</span>])
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>if</span> quantiles:
</span></span><span style=display:flex><span>        interp <span style=color:#ff6ac1>=</span> interp1d(xc, y, bounds_error<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>, fill_value<span style=color:#ff6ac1>=</span>(y[<span style=color:#ff9f43>0</span>], y[<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1</span>]))
</span></span><span style=display:flex><span>        <span style=color:#ff6ac1>for</span> q, q_val <span style=color:#ff6ac1>in</span> <span style=color:#ff5c57>zip</span>(quantiles, df[col]<span style=color:#ff6ac1>.</span>quantile(quantiles)):
</span></span><span style=display:flex><span>            qstr <span style=color:#ff6ac1>=</span> qfmt <span style=color:#ff6ac1>%</span> q_val
</span></span><span style=display:flex><span>            qy <span style=color:#ff6ac1>=</span> interp(q_val) <span style=color:#ff6ac1>+</span> <span style=color:#ff9f43>0.03</span> <span style=color:#ff6ac1>*</span> y<span style=color:#ff6ac1>.</span>max()
</span></span><span style=display:flex><span>            ax<span style=color:#ff6ac1>.</span>axvline(q_val, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.5</span>, ls<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;:&#34;</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>1</span>)
</span></span><span style=display:flex><span>            ax<span style=color:#ff6ac1>.</span>annotate(<span style=color:#5af78e>f</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>{</span><span style=color:#ff9f43>1</span><span style=color:#ff6ac1>-</span>q<span style=color:#5af78e>:</span><span style=color:#5af78e>0.0%</span><span style=color:#5af78e>}</span><span style=color:#5af78e> &gt; </span><span style=color:#5af78e>{</span>qstr<span style=color:#5af78e>}</span><span style=color:#5af78e> </span><span style=color:#5af78e>{</span>col<span style=color:#5af78e>}</span><span style=color:#5af78e>&#34;</span>, (q_val, qy))
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlim(<span style=color:#ff6ac1>*</span>xlim)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlabel(col)
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>plot_hist(df, <span style=color:#5af78e>&#34;Followers&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>500</span>, xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>6000</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plot_hist(df, <span style=color:#5af78e>&#34;Followers&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.75</span>, <span style=color:#ff9f43>0.8</span>], xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>100</span>))
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>get_established</span>(df: pd<span style=color:#ff6ac1>.</span>DataFrame, threshold<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>) <span style=color:#ff6ac1>-&gt;</span> pd<span style=color:#ff6ac1>.</span>DataFrame:
</span></span><span style=display:flex><span>    df <span style=color:#ff6ac1>=</span> df[df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>&gt;</span> threshold]<span style=color:#ff6ac1>.</span>copy()
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Patron Value&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Earnings&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Patron Count&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Patron Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Patron Count&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Favourite Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Favorites&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Follow Rate (Total)&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Total Views&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Follow Rate (Avg)&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Average Views&#34;</span>]
</span></span><span style=display:flex><span>    df[<span style=color:#5af78e>&#34;Rating Rate&#34;</span>] <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Ratings&#34;</span>] <span style=color:#ff6ac1>/</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>return</span> df
</span></span><span style=display:flex><span>df_established <span style=color:#ff6ac1>=</span> get_established(df)
</span></span><span style=display:flex><span><span style=color:#78787e># Use correlation to show pages and rating are the weakest indicators of Followers</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_cor</span>(df):
</span></span><span style=display:flex><span>    cor <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>corr(numeric_only<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>    ax <span style=color:#ff6ac1>=</span> sb<span style=color:#ff6ac1>.</span>heatmap(cor, square<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_title(<span style=color:#5af78e>&#34;Correlations&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>plot_cor(df_established)
</span></span><span style=display:flex><span><span style=color:#78787e># Look into avergae profit per patreon</span>
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Rating&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>40</span>)
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Favourite Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>)
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Rating Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>)
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Follow Rate (Avg)&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>80</span>)
</span></span><span style=display:flex><span><span style=color:#78787e># Covnersion between Followers/Favourites to Patreon count&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_prate</span>(df):
</span></span><span style=display:flex><span>    <span style=color:#78787e># Have to group authors with multiple stories leading to same patreon</span>
</span></span><span style=display:flex><span>    df2 <span style=color:#ff6ac1>=</span> df<span style=color:#ff6ac1>.</span>groupby(<span style=color:#5af78e>&#34;Patreon Link&#34;</span>)<span style=color:#ff6ac1>.</span>sum(numeric_only<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>True</span>)<span style=color:#ff6ac1>.</span>reset_index()
</span></span><span style=display:flex><span>    df2 <span style=color:#ff6ac1>=</span> df2[df2[<span style=color:#5af78e>&#34;Patron Rate&#34;</span>] <span style=color:#ff6ac1>&lt;</span> <span style=color:#ff9f43>1.0</span>]<span style=color:#ff6ac1>.</span>copy()
</span></span><span style=display:flex><span>    plot_hist(df2, <span style=color:#5af78e>&#34;Patron Rate&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;</span><span style=color:#5af78e>%0.3f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>100</span>, xlim<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>0</span>, <span style=color:#ff9f43>0.5</span>), quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.7</span>, <span style=color:#ff9f43>0.9</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plot_prate(df_established)
</span></span><span style=display:flex><span><span style=color:#78787e># Curious about the average value of each patron</span>
</span></span><span style=display:flex><span>plot_hist(df_established, <span style=color:#5af78e>&#34;Patron Value&#34;</span>, qfmt<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;$</span><span style=color:#5af78e>%0.2f</span><span style=color:#5af78e>&#34;</span>, bins<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>55</span>, quantiles<span style=color:#ff6ac1>=</span>[<span style=color:#ff9f43>0.5</span>, <span style=color:#ff9f43>0.75</span>, <span style=color:#ff9f43>0.9</span>, <span style=color:#ff9f43>0.99</span>])
</span></span><span style=display:flex><span><span style=color:#78787e>#Create overview plot</span>
</span></span><span style=display:flex><span><span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>plot_overview</span>(df, ax, fig):
</span></span><span style=display:flex><span>    x <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Rating&#34;</span>]
</span></span><span style=display:flex><span>    y <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Followers&#34;</span>]
</span></span><span style=display:flex><span>    c <span style=color:#ff6ac1>=</span> df[<span style=color:#5af78e>&#34;Pages&#34;</span>]
</span></span><span style=display:flex><span>    s <span style=color:#ff6ac1>=</span> <span style=color:#ff9f43>20</span>
</span></span><span style=display:flex><span>    h <span style=color:#ff6ac1>=</span> ax<span style=color:#ff6ac1>.</span>scatter(x, y, c<span style=color:#ff6ac1>=</span>c, s<span style=color:#ff6ac1>=</span>s, cmap<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;jet&#34;</span>, norm<span style=color:#ff6ac1>=</span>matplotlib<span style=color:#ff6ac1>.</span>colors<span style=color:#ff6ac1>.</span>LogNorm(vmin<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>50</span>, vmax<span style=color:#ff6ac1>=</span>c<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>1.2</span>),)
</span></span><span style=display:flex><span>    divider <span style=color:#ff6ac1>=</span> make_axes_locatable(ax)
</span></span><span style=display:flex><span>    cax <span style=color:#ff6ac1>=</span> divider<span style=color:#ff6ac1>.</span>append_axes(<span style=color:#5af78e>&#39;right&#39;</span>, size<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;2%&#39;</span>, pad<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.05</span>)
</span></span><span style=display:flex><span>    fig<span style=color:#ff6ac1>.</span>colorbar(h, cax<span style=color:#ff6ac1>=</span>cax, orientation<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#39;vertical&#39;</span>, label<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;Pages&#34;</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlim(<span style=color:#ff9f43>3</span>, x<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>1.04</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_ylim(y<span style=color:#ff6ac1>.</span>min(), <span style=color:#ff9f43>1.1</span> <span style=color:#ff6ac1>*</span> y<span style=color:#ff6ac1>.</span>max())
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_xlabel(<span style=color:#5af78e>&#34;Rating&#34;</span>)
</span></span><span style=display:flex><span>    ax<span style=color:#ff6ac1>.</span>set_ylabel(<span style=color:#5af78e>&#34;Followers&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    padding <span style=color:#ff6ac1>=</span> y<span style=color:#ff6ac1>.</span>max() <span style=color:#ff6ac1>*</span> <span style=color:#ff9f43>0.01</span>
</span></span><span style=display:flex><span>    replace <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;He Who Fights With Monsters&#34;</span>: <span style=color:#5af78e>&#34;HWFWM&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Salvos (A Monster Evolution LitRPG)&#34;</span>: <span style=color:#5af78e>&#34;Salvos&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Defiance of the Fall&#34;</span>: <span style=color:#5af78e>&#34;DotF&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;There is no Epic Loot here, Only Puns.&#34;</span>: <span style=color:#5af78e>&#34;Only Puns&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    offset <span style=color:#ff6ac1>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;HWFWM&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.15</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;The Primal Hunter&#34;</span>: (<span style=color:#ff9f43>0.2</span>, <span style=color:#ff9f43>3</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Paranoid Mage&#34;</span>: (<span style=color:#ff9f43>0.22</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Delve&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.12</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.5</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Mark of the Fool&#34;</span>: (<span style=color:#ff9f43>0.15</span>, <span style=color:#ff9f43>1</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Salvos&#34;</span>: (<span style=color:#ff6ac1>-</span><span style=color:#ff9f43>0.15</span>, <span style=color:#ff9f43>0</span>),
</span></span><span style=display:flex><span>        <span style=color:#5af78e>&#34;Only Puns&#34;</span>: (<span style=color:#ff9f43>0.15</span>, <span style=color:#ff6ac1>-</span><span style=color:#ff9f43>1.3</span>),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>def</span> <span style=color:#57c7ff>annotate</span>(i, row):
</span></span><span style=display:flex><span>        t <span style=color:#ff6ac1>=</span> replace<span style=color:#ff6ac1>.</span>get(row[<span style=color:#5af78e>&#39;Title&#39;</span>], row[<span style=color:#5af78e>&#39;Title&#39;</span>])
</span></span><span style=display:flex><span>        o <span style=color:#ff6ac1>=</span> offset<span style=color:#ff6ac1>.</span>get(t, (<span style=color:#ff9f43>0</span>,<span style=color:#ff9f43>1</span>))
</span></span><span style=display:flex><span>        pos <span style=color:#ff6ac1>=</span> x[i], y[i]
</span></span><span style=display:flex><span>        arrow <span style=color:#ff6ac1>=</span> <span style=color:#ff5c57>dict</span>(arrowstyle<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;-&#34;</span>, alpha<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.3</span>, lw<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0.5</span>, shrinkA<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>0</span>, shrinkB<span style=color:#ff6ac1>=</span><span style=color:#ff9f43>3</span>) <span style=color:#ff6ac1>if</span> t <span style=color:#ff6ac1>in</span> offset <span style=color:#ff6ac1>else</span> <span style=color:#ff6ac1>None</span>
</span></span><span style=display:flex><span>        ax<span style=color:#ff6ac1>.</span>annotate(t, pos, (x[i] <span style=color:#ff6ac1>+</span> o[<span style=color:#ff9f43>0</span>], (padding <span style=color:#ff6ac1>*</span> o[<span style=color:#ff9f43>1</span>]) <span style=color:#ff6ac1>+</span> y[i]), va<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;bottom&#34;</span>, ha<span style=color:#ff6ac1>=</span><span style=color:#5af78e>&#34;center&#34;</span>, arrowprops<span style=color:#ff6ac1>=</span>arrow)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> i, row <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>10</span>)<span style=color:#ff6ac1>.</span>iterrows():
</span></span><span style=display:flex><span>        annotate(i, row) 
</span></span><span style=display:flex><span>    <span style=color:#ff6ac1>for</span> i, row <span style=color:#ff6ac1>in</span> df<span style=color:#ff6ac1>.</span>sort_values(<span style=color:#5af78e>&#34;Pages&#34;</span>, ascending<span style=color:#ff6ac1>=</span><span style=color:#ff6ac1>False</span>)<span style=color:#ff6ac1>.</span>head(<span style=color:#ff9f43>1</span>)<span style=color:#ff6ac1>.</span>iterrows():
</span></span><span style=display:flex><span>        annotate(i, row)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>fig, ax <span style=color:#ff6ac1>=</span> plt<span style=color:#ff6ac1>.</span>subplots(figsize<span style=color:#ff6ac1>=</span>(<span style=color:#ff9f43>10</span>, <span style=color:#ff9f43>8</span>))
</span></span><span style=display:flex><span>plot_overview(df_established, ax, fig)
</span></span></code></pre></div><div class="relative max-w-xl mx-auto my-20"><div class="fancy_card horizontal"><div class=card_translator><div class="card_rotator tiny_rot card_layer"><div class="card_layer newsletter p-2"><div class="newsletter-inner h-full"><div class="relative h-full sib-form-container" id=sib-form-container><div class="mb-6 lg:mb-12 text-center"><h3 class="text-main-200 mb-2 lg:mb-8">Stay in the loop!</h3><p class="text-main-100 text-lg text-opacity-70">For new releases, exclusive giveaways, and reviews.</p></div><form action="https://Cosmiccoding.us5.list-manage.com/subscribe/post?u=aebe5de1d2e40dccb3aeca491&id=3987dd4a1f" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class="validate w-full" target=_blank novalidate><div><input type=email class="w-full appearance-none bg-main-600 mb-4 border border-main-600 bg-opacity-5 focus:border-main-300 rounded-sm px-4 py-3 text-main-100 placeholder-main-100 required" placeholder="Your best email" aria-label="Your best email" name=EMAIL required data-required=true id=EMAIL><div style=position:absolute;left:-5000px aria-hidden=true><input type=text name=b_aebe5de1d2e40dccb3aeca491_3987dd4a1f tabindex=-1></div><input type=submit value=Subscribe name=subscribe id=mc-embedded-subscribe class="button btn bg-main-600 hover:bg-main-400 shadow w-full"></div><p id=mce-error-response style=display:none class="text-center mt-2 opacity-50 text-main-200">There was a problem, please try again.</p><p id=mce-success-response style=display:none class="text-center mt-2 opacity-50 text-main-200">Thanks mate, won't let ya down.</p></form></div></div></div><div class="card_layer card_effect card_soft_glare" style=pointer-events:none></div></div></div></div></div></div></div><script language=javascript type=text/javascript src=https://cosmiccoding.com.au/js/main.min.11673d10a962fb5205229607e62ea1d23424d35dad33db7bfe2a09a63d5409fa.js></script>
<script async defer src="https://www.googletagmanager.com/gtag/js?id=G-GRX6QE03YR"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GRX6QE03YR")</script></div></body></html>